<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-site-verification" content="m_tuijAsu4x4BQh9CLHY_2FST6EpNVBiieQh0nH8MRU" />
    <title>plan-pulse-ai-flow</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />

    <meta property="og:title" content="plan-pulse-ai-flow" />
    <meta property="og:description" content="Lovable Generated Project" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
(function () {
  // Read ?email & ?src from URL
  const qs = new URLSearchParams(window.location.search);
  const email = (qs.get('email') || '').trim();
  const src   = (qs.get('src') || '').trim().toLowerCase();
  const isEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

  // Find form + email input + CTA
  const form       = document.querySelector('form') || document.querySelector('[data-waitlist-form]');
  const emailInput = document.querySelector('input[type="email"], input[name="email"], #email');
  const submitBtn  = document.querySelector('button[type="submit"], button#join, [data-primary-cta]');

  // Prefill & lock (optional)
  if (isEmail && emailInput) {
    emailInput.value = decodeURIComponent(email);
    emailInput.setAttribute('readonly', 'readonly');      // keeps friction low
    emailInput.dispatchEvent(new Event('input', {bubbles:true}));

    // Show small helper line under the field
    const helper = document.createElement('div');
    helper.textContent = `Signed in as ${email} • Change`;
    helper.style.cssText = 'margin-top:6px;font-size:12px;color:#6b7280;cursor:pointer;';
    emailInput.insertAdjacentElement('afterend', helper);
    helper.addEventListener('click', () => {
      emailInput.removeAttribute('readonly');
      emailInput.focus();
    });
  }

  // Make anchor CTAs submit the form (if any)
  document.querySelectorAll('a#join, a[data-primary-cta]').forEach(a => {
    a.addEventListener('click', (e) => {
      if (form) { e.preventDefault(); form.requestSubmit(); }
    });
  });

  // OPTIONAL: true one‑click join for Beehiiv traffic
  // Enable only when URL includes &src=beehiiv
  if (form && isEmail && (src === 'beehiiv')) {
    setTimeout(() => form.requestSubmit(), 400); // let any form libs init
  }
})();
</script>
  </body>
</html>
